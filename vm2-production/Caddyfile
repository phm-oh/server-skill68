# Caddyfile - Reverse Proxy Configuration
# สำหรับ VM2 Production Server (HTTP Only - No SSL)
#
# Caddy จะทำหน้าที่เป็น reverse proxy ไปยัง services ต่างๆ

# ปิด Auto HTTPS (เราไม่ใช้ SSL)
{
    auto_https off
    http_port 80
}

# Main site - เข้าที่ IP โดยตรง
:80 {
    # Log requests
    log {
        output stdout
        format console
    }

    # API Routes -> Backend
    handle /api/* {
        reverse_proxy backend:3000
    }

    # Health check endpoint
    handle /health {
        respond "OK" 200
    }

    # All other requests -> Frontend
    handle {
        reverse_proxy frontend:80
    }
}

# Alternative: ถ้าอยากแยก subdomain/port แต่ละ service
# ลบ comment ด้านล่างถ้าต้องการใช้

# :3000 {
#     reverse_proxy backend:3000
# }

# :8080 {
#     reverse_proxy frontend:80
# }
